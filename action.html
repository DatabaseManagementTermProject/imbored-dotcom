<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Simple Test</title>
        
    </head>
    <body>
        <form class="form">
            <select name="library" id="library">
                <option value="books">Books</option>
                <option value="movies">Movies</option>
                <option value="videoGames">Video Games</option>
            </select>
            <select name="action" id="action">
                <option value="getArray">getArray</option>
                <option value="add">Add</option>
                <option value="delete">Delete</option>
            </select>
            TableID: <input type="text" name="tableID" id="tableID">
            <br><br>
            <button type="submit">Submit</button>
        </form>
        <p id="textDisplay">Display here</p>
        
        <script>
            const formEL = document.querySelector("form");
            formEL.addEventListener("submit", event => {
                event.preventDefault();
                const formData = new FormData(formEL);

                let url;
                let id = document.getElementById("tableID").value;
                let library = document.getElementById("library").value;
                let action = document.getElementById("action").value;

                if (id){
                    url = `http://localhost:3002/get/-1/${library}/${action}/${id}`;
                } else {
                    id = -1;
                    url = `http://localhost:3002/get/-1/${library}/${action}/-1`;
                }
                console.log("url: ", url);

                fetch(url)
                    .then(res => res.json())
                    .then(data => {
                        console.log("frontend", data);

                        // if there is an id, then display the the title
                        if (id >= 0){
                            document.getElementById("textDisplay").innerHTML = data["title"];
                        } else {
                            console.log("The id is " , id);
                            let display = "";
                            for (let i = 0; i < data.length; i++) {
                                display += data[i]["title"] + "<br>";
                            }
                            document.getElementById("textDisplay").innerHTML = display;
                        }
                    })
                    .catch(error => console.log(error));
            })
        </script>
    </body>
</html>
